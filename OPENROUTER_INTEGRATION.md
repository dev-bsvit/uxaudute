# üîÑ OpenRouter Integration - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

> **–í–µ—Ç–∫–∞**: `feature/openrouter-integration`  
> **–î–∞—Ç–∞**: $(date)  
> **–°—Ç–∞—Ç—É—Å**: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ  
> **–¶–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å OpenRouter –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É OpenAI –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

## üìã –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### ‚úÖ **–≠—Ç–∞–ø 1: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞**
- [x] –°–æ–∑–¥–∞–Ω–∞ –≤–µ—Ç–∫–∞ `feature/openrouter-integration`
- [x] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ main
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### ‚úÖ **–≠—Ç–∞–ø 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ó–ê–í–ï–†–®–ï–ù)**
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è OpenRouter
- [x] –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OpenRouter (`src/lib/openrouter.ts`)
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å fallback (`src/lib/ai-provider.ts`)

### ‚úÖ **–≠—Ç–∞–ø 3: API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ó–ê–í–ï–†–®–ï–ù)**
- [x] –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π endpoint –¥–ª—è OpenRouter (`/api/test-openrouter`)
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints (`/api/research-with-fallback`)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å fallback —Å–∏—Å—Ç–µ–º—É

### üîÑ **–≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ OpenRouter —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback –º–µ—Ö–∞–Ω–∏–∑–º

### üîÑ **–≠—Ç–∞–ø 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å env.example
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API_REFERENCE.md
- [ ] –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üõ°Ô∏è –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **–ù–µ –Ω–∞—Ä—É—à–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
1. **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö** –∏–ª–∏ —Å —á–µ—Ç–∫–∏–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
2. **Fallback –Ω–∞ OpenAI** –µ—Å–ª–∏ OpenRouter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
3. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** - –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω—ã, —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```
src/lib/
‚îú‚îÄ‚îÄ openai.ts              # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π (–ù–ï –¢–†–û–ì–ê–ï–ú)
‚îú‚îÄ‚îÄ openrouter.ts          # –ù–û–í–´–ô —Ñ–∞–π–ª –¥–ª—è OpenRouter
‚îî‚îÄ‚îÄ ai-provider.ts         # –ù–û–í–´–ô —Ñ–∞–π–ª –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### **–ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ):**
```bash
# OpenRouter (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
OPENROUTER_API_KEY=your_openrouter_api_key
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet

# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: openai)
AI_PROVIDER_PRIORITY=openai,openrouter
```

## üöÄ –ù–æ–≤—ã–µ API Endpoints

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OpenRouter:**
- **GET /api/test-openrouter** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **POST /api/test-openrouter** - –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ OpenRouter

### **–ê–Ω–∞–ª–∏–∑ —Å fallback —Å–∏—Å—Ç–µ–º–æ–π:**
- **POST /api/research-with-fallback** - UX –∞–Ω–∞–ª–∏–∑ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

### **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**
- **POST /api/research-experimental** - UX –∞–Ω–∞–ª–∏–∑ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏ –º–æ–¥–µ–ª–∏

### **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

#### –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
curl -X GET https://uxaudute.vercel.app/api/test-openrouter
```

#### –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```bash
curl -X POST https://uxaudute.vercel.app/api/test-openrouter
```

#### –ê–Ω–∞–ª–∏–∑ —Å fallback:
```bash
curl -X POST https://uxaudute.vercel.app/api/research-with-fallback \
  -H "Content-Type: application/json" \
  -d '{"url": "https://example.com", "context": "E-commerce site"}'
```

#### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (OpenAI):
```bash
curl -X POST https://uxaudute.vercel.app/api/research-experimental \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://example.com", 
    "context": "E-commerce site",
    "provider": "openai"
  }'
```

#### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (OpenRouter Sonoma):
```bash
curl -X POST https://uxaudute.vercel.app/api/research-experimental \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://example.com", 
    "context": "E-commerce site",
    "provider": "openrouter",
    "openrouterModel": "sonoma"
  }'
```

#### –¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏:
```bash
curl -X POST https://uxaudute.vercel.app/api/test-openrouter \
  -H "Content-Type: application/json" \
  -d '{"model": "sonoma"}'
```

## üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### **–õ–æ–≥–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –Ω–∞ –ª—é–±–æ–π —ç—Ç–∞–ø

### **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏:**
1. ‚úÖ –†–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ
2. üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OpenRouter
3. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ API endpoints
4. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. ‚è≥ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üö® –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Ç–∫–∞—Ç–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫:
```bash
# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞–±–æ—á–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
git checkout main
git branch -D feature/openrouter-integration

# –ò–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git checkout HEAD~1 -- src/lib/openrouter.ts
```

---
*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏*
