# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–§—É–Ω–∫—Ü–∏—è `ensureUserHasInitialBalance` –æ–±–Ω–æ–≤–ª–µ–Ω–∞:**
   - –î–æ–±–∞–≤–ª–µ–Ω `service role client` –¥–ª—è –æ–±—Ö–æ–¥–∞ RLS
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `source` –Ω–∞ `'manual'`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:**
   - Email —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: `signUpWithEmail` ‚Üí `ensureUserHasInitialBalance`
   - Google OAuth: `layout.tsx` ‚Üí `ensureUserHasInitialBalance` –ø—Ä–∏ `SIGNED_IN`

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### 1. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://uxaudute.vercel.app/
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å –Ω–æ–≤—ã–º email
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ 5 –∫—Ä–µ–¥–∏—Ç–æ–≤

### 2. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Google OAuth:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://uxaudute.vercel.app/
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
4. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ 5 –∫—Ä–µ–¥–∏—Ç–æ–≤

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –ª–æ–≥–∏:
- `üîç ensureUserHasInitialBalance –≤—ã–∑–≤–∞–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: [USER_ID]`
- `üí∞ –°–æ–∑–¥–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: [USER_ID]`
- `‚úÖ –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: [USER_ID]`

## üîß API –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

```bash
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST https://uxaudute.vercel.app/api/fix-user-balance \
  -H "Content-Type: application/json" \
  -d '{"userId": "USER_ID_–ó–î–ï–°–¨"}'

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –±–∞–ª–∞–Ω—Å–∞
curl -X POST https://uxaudute.vercel.app/api/fix-all-users-balance
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```bash
curl -X GET https://uxaudute.vercel.app/api/list-users
```

## ‚ö†Ô∏è –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `SUPABASE_SERVICE_ROLE_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

- –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç 5 –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–ª—è email, —Ç–∞–∫ –∏ –¥–ª—è Google OAuth
- –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
- –ë–∞–ª–∞–Ω—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
