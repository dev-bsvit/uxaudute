# Requirements Document

## Introduction

Исправление проблемы с качеством ответов в мультиязычной системе. В stable ветке русский промпт работает отлично и дает полные качественные ответы, но в main ветке с мультиязычностью ответы стали обрезанными и неполными как на русском, так и на английском языке. Необходимо восстановить качество ответов из stable ветки, сохранив мультиязычную функциональность.

## Requirements

### Requirement 1

**User Story:** Как пользователь, я хочу получать полные качественные ответы на русском языке, такие же как в stable ветке, чтобы анализ был максимально полезным

#### Acceptance Criteria

1. WHEN пользователь запрашивает анализ на русском языке THEN система SHALL возвращать полный ответ такого же качества как в stable ветке
2. WHEN система обрабатывает русский промпт THEN она SHALL использовать точную структуру и содержание промпта из stable ветки
3. WHEN анализ завершается THEN ответ SHALL содержать все разделы без обрезания

### Requirement 2

**User Story:** Как пользователь, я хочу получать полные качественные ответы на английском языке, чтобы система работала корректно для международных пользователей

#### Acceptance Criteria

1. WHEN пользователь запрашивает анализ на английском языке THEN система SHALL возвращать полный ответ на английском языке
2. WHEN система использует английский промпт THEN он SHALL быть точным переводом русского промпта из stable ветки
3. WHEN анализ на английском завершается THEN ответ SHALL быть на английском языке, а не на русском

### Requirement 3

**User Story:** Как разработчик, я хочу использовать стабильные промпты из stable ветки как основу для всех языков, чтобы обеспечить консистентность качества

#### Acceptance Criteria

1. WHEN система загружает промпты THEN она SHALL использовать структуру и содержание из stable ветки
2. WHEN создается английская версия промпта THEN она SHALL быть точным переводом русской версии без изменения структуры
3. WHEN промпт отправляется в AI THEN он SHALL содержать все необходимые инструкции для полного ответа

### Requirement 4

**User Story:** Как администратор системы, я хочу исключить проблемы с токенами и упрощенными промптами, чтобы убедиться что проблема именно в логике мультиязычности

#### Acceptance Criteria

1. WHEN система проверяет лимиты токенов THEN она SHALL подтвердить что токенов достаточно для полного ответа
2. WHEN используются тестовые промпты THEN система SHALL работать только с основными промптами
3. WHEN выявляется источник проблемы THEN он SHALL быть локализован в логике мультиязычности, а не в других компонентах

### Requirement 5

**User Story:** Как пользователь, я хочу чтобы система корректно определяла язык и использовала соответствующий промпт, чтобы получать ответы на нужном языке

#### Acceptance Criteria

1. WHEN пользователь выбирает русский язык THEN система SHALL использовать русский промпт и возвращать русский ответ
2. WHEN пользователь выбирает английский язык THEN система SHALL использовать английский промпт и возвращать английский ответ
3. WHEN происходит переключение языка THEN система SHALL корректно обновлять промпт без потери качества